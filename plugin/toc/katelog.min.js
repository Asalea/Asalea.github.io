"use strict";var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"function"==typeof define&&define.amd?define(function(){return t}):"object"===("undefined"==typeof exports?"undefined":y(exports))?module.exports=t:e.katelog=t}(window,function(e){function s(e,t){return!!e.className&&e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))}function f(e,t){if(s(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ")}}function t(e){for(var t,n=void 0,o=[],a={},i={id:-1},l=null,r=void 0,c=0;c<e.length;c++)r="heading-"+c,a={name:e[c].innerText||e[c].textContent,tagName:n=e[c].tagName,id:e[c].id=r,level:(t=n,t?t.slice(1):0),parent:i},l&&(d(a.tagName)<d(l.tagName)?a.parent=l:a.parent=u(a,l)),l=a,o.push(a);return o}function u(e,t){for(var n=t.parent;n&&d(e.tagName)>=d(n.tagName);)n=n.parent;return n||{id:-1}}function d(e){var t=0;if(e)switch(e.toLowerCase()){case"h1":t=6;break;case"h2":t=5;break;case"h3":t=4;break;case"h4":t=3;break;case"h5":t=2;break;case"h6":t=1}return t}function n(e,t,n){e&&(e.attachEvent?(e["e"+t+n]=n,e[t+n]=function(){e["e"+t+n](window.event)},e.attachEvent("on"+t,e[t+n])):e.addEventListener(t,n,!1))}function r(e,t){var n,o,a=void 0,i=!1;if(e){a="<ul>";for(var l=0;l<e.length;l++)o=t,(n=e[l].parent)&&o&&"object"===(void 0===n?"undefined":y(n))&&"object"===(void 0===o?"undefined":y(o))&&n.id===o.id&&(i=!0,a+='<li><div class="'+p.linkClass+" k-catelog-level-"+e[l].level+'" data-target="'+e[l].id+'">'+e[l].name+"</div>",a+=r(e,e[l]),a+="</li>");a+="</ul>"}return i?a:""}"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),o=1;o<arguments.length;o++){var a=arguments[o];if(null!=a)for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])}return n},writable:!0,configurable:!0});var p=Object.assign({},{linkClass:"k-catelog-link",linkActiveClass:"k-catelog-link-active",supplyTop:0,selector:["h1","h2","h3","h4","h5","h6"],active:null},e),o=this.contentEl=document.getElementById(p.contentEl),g=document.getElementById(p.catelogEl),a=o.querySelectorAll(p.selector.join()),i=t(a),l=!1;g.innerHTML=r(i,{id:-1});var c="\n        .k-catelog-list { overflow: hidden !important; }\n        .k-catelog-list > ul { position: relative; }    \n    ",h=document.createElement("style");function v(e){var t,n=g.querySelectorAll("[data-target]");t=n,n=Array.prototype.slice.call(t);for(var o,a,i,l=null,r=void 0,c=0;c<n.length;c++)"target",((i=r=n[c]).dataset?i.dataset.target:i.getAttribute("data-target"))===e?(s(o=r,a=p.linkActiveClass)||(o.className+=" "+a),l=r,g.children[0].offsetHeight>g.offsetHeight&&(r.offsetTop>g.offsetHeight/2?g.children[0].offsetHeight-r.offsetTop-r.offsetHeight<g.offsetHeight/2?g.children[0].style.marginTop=-g.children[0].offsetHeight+g.offsetHeight+"px":g.children[0].style.marginTop=g.offsetHeight/2-r.offsetTop+"px":g.children[0].style.marginTop="0px")):f(r,p.linkActiveClass);"function"==typeof p.active&&p.active.call(this,l)}function m(e){for(var t=e.offsetTop;e=e.offsetParent;)t+=e.offsetTop;return t}h.type="text/css",h.styleSheet?h.styleSheet.cssText=c:h.innerHTML=c,document.getElementsByTagName("head")[0].appendChild(h),n(g,"click",function(e){var t=(e.target||e.srcElement).getAttribute("data-target");if(t){var n=document.getElementById(t);l=!0,window.scrollTo(0,n.offsetTop-p.supplyTop),v(t)}}),n(window,"scroll",function(e){if(!l){for(var t=(document.documentElement.scrollTop||document.body.scrollTop)+p.supplyTop,n=null,o=a.length-1;0<=o;o--)if(m(a[o])<=t){n=a[o];break}v(n?n.id:null)}l=!1}),this.rebuild=function(){var e=t(a=o.querySelectorAll(p.selector.join()));g.innerHTML=r(e,{id:-1})}});